<ion-content class="ion-padding-vertical">
  <ion-grid class="ion-padding" *ngIf="user">
    <ion-row>
      <ion-col size="9">
        <ion-label>
          <h2>¡Bienvenido!</h2>
          <h1>{{ user.plant.name }} - {{ user.plant.campus }}</h1>
        </ion-label>
      </ion-col>
      <ion-col size="3" class="profile-img">
        <ion-avatar class="ion-no-margin">
          <img
            src="{{ user.image_url }}"
            alt="User avatar"
            [routerLink]="['/profile']"
          />
        </ion-avatar>
        <ion-label>
          <p [routerLink]="['/profile']">Ver perfil</p>
        </ion-label>
      </ion-col>
    </ion-row>
  </ion-grid>

  <div class="ion-padding chart-card">
    <ion-label> Métricas </ion-label>
    <ion-card>
      <ion-grid>
        <ion-row>
          <ion-col size="4" class="col-1-chart">
            <h2 class="ion-no-margin" *ngIf="graphicData">
              {{percentage}} %
            </h2>
            <p class="ion-no-margin">aumento de proveedores</p>
            <p class="ion-no-margin">comparado al mes anterior</p>
          </ion-col>
          <ion-col size="8">
            <canvas #barCanvas></canvas>
          </ion-col>
        </ion-row>
      </ion-grid>
    </ion-card>
  </div>

  <div class="ion-padding">
    <ion-searchbar
      placeholder="Buscar SCTR"
      mode="ios"
      (ionInput)="handleInput($event)"
    ></ion-searchbar>
    <div>
      <ion-list mode="ios">
        <ion-item
          class="ion-margin-vertical"
          *ngFor="let insurance of insuranceTypes"
          lines="none"
        >
          <ion-avatar>
            <img src="{{ insurance.contratist.image_url }}" />
          </ion-avatar>
          <ion-label class="ion-padding-start">
            <h2>{{ insurance.contratist.business }}</h2>
            <p>SCTR {{ insurance.type.name }}</p>
          </ion-label>
          <ion-button
            color="success"
            (click)="navigateToInsurance(insurance.id)"
            mode="ios"
          >
            Ver más
          </ion-button>
        </ion-item>
      </ion-list>
    </div>
  </div>

  <ion-fab
    vertical="bottom"
    horizontal="end"
    slot="fixed"
    (click)="goToQrPage()"
  >
    <ion-fab-button>
      <ion-icon name="qr-code-outline"></ion-icon>
    </ion-fab-button>
  </ion-fab>
  <app-footer></app-footer>
</ion-content>
